pipeline {
  agent any
  stages{
       stage ('Build'){
        steps {
          bat 'mvn clean package'
        }
         post {
           success {
             echo 'Archiving...'
             archiveArtifacts artifacts:'**/target/*.war'
           }
         }
       }
       stage ('Deployments') {
  
           stage ('Deploy to Staging'){
             steps {
               echo "COPY /Y webapp\\target\\*.war C:\\Projects\\apache-tomcat-staging\\webapps"
               build job:'deploy_to_staging'
             }
           }
           stage ('Deploy to prod') {
             steps {
               echo "COPY /Y webapp\\target\\*.war C:\\Projects\\apache-tomcat-prodact\\webapps"
               timeout(time:5, unit:'DAYS'){
                 input message:'Approve Prod deployment'
               }
               build job:'deploy_to_prod'
                
           }
         }
       }
    }
} 
